---
title: "Data Mining Assignment"
author: "by Jad Obeid, Marwa Ghraizi and Patrick Nohra"
date: (November 14, 2021)
output: 
  html_document:
    theme: readable
    highlight: espresso
    number_sections: false
    toc : yes 
    toc_depth : 3
    toc_float:
      collapsed: false
      smooth_scroll: true
---
In the following report, we will first explore data representing car acceptability based on multiple features. After that, we will perform and analyze four machine learning models to predict car acceptability: Logistic Regression, LDA, QDA and KNN.

# Exploring the Data
We begin by reading the data using the **<span style="color: orange;">`read.csv()`</span>** function.
## Reading the Data
```{r}
data=read.csv('C:/Users/Patss/Desktop/Fall2021/Data Mining/Starting R/Training R/DataAssign2.csv', stringsAsFactors  =FALSE)
```
## Cleaning the Data
For better readability, we changed the column names into their corresponding predictors' names (Price, MaintenancePrice, NbDoors, PersonsCapacity, LuggageSize and Safety) as well as changing the response column into "Acceptability".
```{r}
names(data)= c('Price', 'MaintenancePrice', 'NbDoors', 'PersonsCapacity', 'LuggageSize', 'Safety', 'Acceptability')
#summary(data$NbDoors)
```
Seeing that the quantitative predictors **<span style="color: green;"> `NbDoors & PersonsCapacity` </span>** contain non numeric data values (5more and more) we used the **<span style="color: orange;">`ifelse()`</span>** function followed by the **<span style="color: orange;">`as.numeric()`</span>** function to assign the data type as consistent numbers.
```{r}
data$NbDoors <- ifelse(data$NbDoors == '5more', '5', data$NbDoors)
data$NbDoors = as.numeric(data$NbDoors)

data$PersonsCapacity <- ifelse(data$PersonsCapacity == 'more', '6', data$PersonsCapacity)
data$PersonsCapacity = as.numeric(data$PersonsCapacity)
```
## Factors Ordering
As for the qualitative predictors, once the data is imported, their values are mapped to factors which are data structures used to categorize and store qualitative data as levels. In our case, the level of measurement of the qualitative predictors Price, MaintenancePrice, LuggageSize and Safety is ordinal and since factors in R are ordered alphabetically, we must change them to reflect the correct order of the categories in each predictor.

```{r}
cat("Original factor levels:",levels(data$Price))
data$Price=factor(data$Price, levels = c("low","med","high","vhigh"))
cat("Newly ordered factor levels:",levels(data$Price))
data$MaintenancePrice=factor(data$MaintenancePrice, levels = c("low","med","high","vhigh"))
data$LuggageSize=factor(data$LuggageSize, levels = c("small","med","big"))
data$Safety=factor(data$Safety, levels = c("low","med","high"))


data$Acceptability=factor(data$Acceptability, levels = c("bad","good"))

```
## Plotting Categorical Predictors
Creating frequency tables
```{r}
PriceTable = table(data$Price,data$Acceptability)
MaintenancePriceTable = table(data$MaintenancePrice,data$Acceptability)
LuggageTable = table(data$LuggageSize,data$Acceptability)
SafetyTable = table(data$Safety,data$Acceptability)
```
## Mosaic Plots
```{r}
mosaicplot(PriceTable,main="CarPrice vs Acceptability", xlab = "Car Price",ylab="Acceptability", col=c(2,3))
mosaicplot(MaintenancePriceTable,main="MaintenancePrice vs Acceptability", xlab = "Maintenance Price",ylab="Acceptability", col=c(2,3))
mosaicplot(LuggageTable,main="LuggageSize vs Acceptability", xlab = "Luggage Size",ylab="Acceptability", col=c(2,3))
mosaicplot(SafetyTable,main="Safety vs Acceptability", xlab = "safety Level",ylab="Acceptability", col=c(2,3))
```
## Boxplots
for the other 2 predictors
```{r}
plot(data$Acceptability, data$NbDoors, col="red", varwidth=T, xlab="Number of Doors", ylab="Acceptability")
plot(data$Acceptability, data$PersonsCapacity, col="red", varwidth=T, xlab="Persons Capacity", ylab="Acceptability")
```

